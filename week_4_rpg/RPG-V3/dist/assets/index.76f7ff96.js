import{C as k,T as d,S as p,B as z,R as x,a as S,g as C,P as j,A as J}from"./vendor.288463a8.js";const R=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=e(i);fetch(i.href,r)}};R();var g;(function(a){a.\u5065\u5EB7="\u5065\u5EB7",a.\u6688\u7729="\u6688\u7729",a.\u6DF7\u4E82="\u6DF7\u4E82"})(g||(g={}));var F;(function(a){a[a.\u596E\u529B\u4E00\u640F=1.5]="\u596E\u529B\u4E00\u640F"})(F||(F={}));var c;(function(a){a.\u53CD\u64CA="\u53CD\u64CA",a.\u9583\u907F="\u9583\u907F",a.\u9023\u64CA="\u9023\u64CA",a.\u706B\u7403="\u706B\u7403",a.\u596E\u529B\u4E00\u640F="\u596E\u529B\u4E00\u640F",a.\u751F\u547D\u529B="\u751F\u547D\u529B",a.\u9B45\u60D1="\u9B45\u60D1",a.\u5438\u6536="\u5438\u6536"})(c||(c={}));var n;(function(a){a.\u4EBA\u985E="\u4EBA\u985E",a.\u77EE\u4EBA="\u77EE\u4EBA",a.\u5996\u7CBE="\u5996\u7CBE",a.\u9A0E\u58EB="\u9A0E\u58EB",a.\u76DC\u8CCA="\u76DC\u8CCA",a.\u6CD5\u5E2B="\u6CD5\u5E2B"})(n||(n={}));var B;(function(a){a.CCC="background: #CCC; color: #000",a.FDF="background: #fdfd99; color: #000; font-weight: bold"})(B||(B={}));class H{constructor(t){this.name=[],this.name.push(t),this.roleInfo={HP:300,MaxHP:300,strength:10,state:[g.\u5065\u5EB7]}}async action(t,e){}isAction(t){return t.state=[...this.roleInfo.state],new Promise(e=>{this.roleInfo.state.find((i,r,o)=>{if(i===g.\u6688\u7729)return o.splice(r,1),e(!1),i;if(i===g.\u6DF7\u4E82)return o.splice(r,1),this.roleInfo.HP-=this.roleInfo.strength,i}),e(!0)})}}function f(a){return function(t,e,s){const i=s.value;s.value=function(r,o){Math.random()>=a||i.call(this,r,o)}}}class w{constructor(t){this.player=t,this.name=t.name,this.roleInfo=t.roleInfo}async action(t,e){this.player.action(t,e)}async isAction(t){return this.player.isAction(t)}}var G=Object.defineProperty,K=Object.getOwnPropertyDescriptor,E=(a,t,e,s)=>{for(var i=s>1?void 0:s?K(t,e):t,r=a.length-1,o;r>=0;r--)(o=a[r])&&(i=(s?o(t,e,i):o(i))||i);return s&&i&&G(t,e,i),i};class D extends w{async action(t,e){await this.isAction(t)&&(t.damage.push(this.attack()),this.proSkill(t,e),this.baseSkill(t,e),this.player.action(t,e))}attack(){return this.roleInfo.strength}baseSkill(t,e){e.damage.shift(),t.defDamage.push(this.attack()),t.skill.push(c.\u53CD\u64CA)}proSkill(t,e){t.damage.push(this.roleInfo.strength*1.5),t.text.proSkill=`${this.player.name[0]} \u91CD\u64CA\u767C\u52D5\uFF0C\u9020\u6210\u4E86 ${this.roleInfo.strength*1.5} \u9EDE\u50B7\u5BB3`}constructor(t){t.name.push(n.\u9A0E\u58EB);super(t)}}E([f(.1)],D.prototype,"baseSkill",1);E([f(.2)],D.prototype,"proSkill",1);class b extends w{async action(t,e){await this.isAction(t)&&(t.damage.push(this.attack()),this.proSkill(t,e),this.baseSkill(t,e),this.player.action(t,e))}attack(){return this.roleInfo.strength*.8}baseSkill(t,e){e.damage=[],t.skill.push(c.\u9583\u907F)}proSkill(t,e){t.damage.push(this.attack()),t.text.proSkill=`${this.player.name[0]} : \u9023\u64CA\u767C\u52D5`,t.skill.push(c.\u9023\u64CA)}constructor(t){t.name.push(n.\u76DC\u8CCA);super(t)}}E([f(.15)],b.prototype,"baseSkill",1);E([f(.4)],b.prototype,"proSkill",1);class A extends w{async action(t,e){await this.isAction(t)&&(t.damage.push(this.attack()),this.proSkill(t,e),this.baseSkill(t,e),this.player.action(t,e))}attack(){return Math.random()>=.8?0:this.roleInfo.strength*1.2}baseSkill(t,e){t.damage.forEach(s=>{t.heal.push(s)})}proSkill(t,e){t.damage.push(this.roleInfo.strength*2),t.debuff.push(g.\u6688\u7729),t.skill.push(c.\u706B\u7403)}constructor(t){t.name.push(n.\u6CD5\u5E2B);super(t)}}E([f(.1)],A.prototype,"baseSkill",1);E([f(.1)],A.prototype,"proSkill",1);var W=Object.defineProperty,X=Object.getOwnPropertyDescriptor,q=(a,t,e,s)=>{for(var i=s>1?void 0:s?X(t,e):t,r=a.length-1,o;r>=0;r--)(o=a[r])&&(i=(s?o(t,e,i):o(i))||i);return s&&i&&W(t,e,i),i};class N extends w{async action(t,e){this.raceSkill(t,e),this.player.action(t,e)}get HPpercent(){return this.roleInfo.HP/this.roleInfo.MaxHP}raceSkill(t,e){this.HPpercent>.2||(t.buff=F.\u596E\u529B\u4E00\u640F,t.text.raceSkill=`${this.player.name[0]} : ${c.\u596E\u529B\u4E00\u640F}\u767C\u52D5`)}constructor(t){t.name.push(n.\u4EBA\u985E);super(t)}}class I extends w{async action(t,e){this.raceSkill(t,e),this.player.action(t,e)}get HPpercent(){return this.roleInfo.HP/this.roleInfo.MaxHP}raceSkill(t,e){if(this.HPpercent>.5)return;const s=this.roleInfo.MaxHP*.05;t.heal.push(s),t.text.raceSkill=`${this.player.name[0]} : ${c.\u751F\u547D\u529B}\u767C\u52D5\uFF0C\u56DE\u5FA9\u4E86 ${s} \u9EDE\u751F\u547D\u503C`,console.log(`${this.player.name[0]} : ${c.\u751F\u547D\u529B}\u767C\u52D5\uFF0C\u56DE\u5FA9\u4E86 ${s} \u9EDE\u751F\u547D\u503C`)}constructor(t){t.name.push(n.\u77EE\u4EBA);super(t)}}class _ extends w{async action(t,e){this.raceSkill(t,e),this.player.action(t,e)}raceSkill(t,e){t.debuff.push(g.\u6DF7\u4E82),t.text.raceSkill=`${this.player.name[0]} : ${c.\u9B45\u60D1}\u767C\u52D5`}constructor(t){t.name.push(n.\u5996\u7CBE);super(t)}}q([f(.1)],_.prototype,"raceSkill",1);class U{static create(){let t=new H("\u96FB\u8166");switch(Math.floor(Math.random()*3)){case 0:t=new N(t);break;case 1:t=new I(t);break;case 2:t=new _(t);break}switch(Math.floor(Math.random()*3)){case 0:t=new D(t);break;case 1:t=new b(t);break;case 2:t=new A(t);break}return console.log(`\u5C0D\u4E0A : ${t.name}`),t}}class v{static create(t){let e=!1;switch(t.text){case n.\u4EBA\u985E:this._player=new N(this._player);break;case n.\u77EE\u4EBA:this._player=new I(this._player);break;case n.\u5996\u7CBE:this._player=new _(this._player);break;case n.\u9A0E\u58EB:this._player=new D(this._player),e=!0;break;case n.\u76DC\u8CCA:this._player=new b(this._player),e=!0;break;case n.\u6CD5\u5E2B:this._player=new A(this._player),e=!0;break}this.changeText(t),e&&l.Start(this._player)}static changeText(t){t.parent.children[0].text="\u9078\u64C7\u8077\u696D",t.parent.children[1].text=n.\u9A0E\u58EB,t.parent.children[2].text=n.\u76DC\u8CCA,t.parent.children[3].text=n.\u6CD5\u5E2B}}v._player=new H("\u73A9\u5BB6");class M{constructor(){this.damage=[],this.defDamage=[],this.heal=[],this.state=[],this.skill=[],this.debuff=[],this.buff=1,this.text={}}}class Q{constructor(t){this.app=t,this.playerContainer=new k,this.computerContainer=new k,this.playerHero=new d(""),this.playerHP=new d(""),this.computerHP=new d(""),this.setPlayer(),this.setComputer(),this.setToApp()}setPlayer(){const t=l.player.name[2],e=p.from(this.switchPath(t));this.playerHP.text=`${l.player.name[0]} : ${l.player.roleInfo.HP}`,this.playerContainer.name="\u73A9\u5BB6",e.anchor.set(.5,1),e.scale.set(-124/96,124/96),this.playerHP.position.set(-62,-235),this.playerHero.position.set(-22,-205),this.playerContainer.position.set(362,325),this.playerHero.text=`${l.player.name[1]}${l.player.name[2]}`,this.playerContainer.addChild(e,this.playerHero,this.playerHP)}setComputer(){const t=l.computer.name[2],e=p.from(this.switchPath(t)),s=new d(l.computer.name[1]+l.computer.name[2]);this.computerHP.text=`${l.computer.name[0]} : ${l.computer.roleInfo.HP}`,this.computerContainer.name="\u96FB\u8166",e.anchor.set(.5,1),e.scale.set(124/96,124/96),s.position=this.playerHero.position,this.computerHP.position=this.playerHP.position,this.computerContainer.y=this.playerContainer.y,this.computerContainer.x=this.playerContainer.x+276,this.computerContainer.addChild(e,s,this.computerHP)}switchPath(t){const e=z.from("character.png"),s=96;let i;switch(t){case n.\u9A0E\u58EB:i=new x(s*1,s*1,s,s);break;case n.\u76DC\u8CCA:i=new x(s*7,s*1,s,s);break;case n.\u6CD5\u5E2B:i=new x(s*1,s*5,s,s);break}return new S(e,i)}setToApp(){this.app.stage.addChild(this.playerContainer,this.computerContainer)}}class h{static doubleSpeed(){switch(this.speed){case 1:this.speed=2;break;case 2:this.speed=4;break;case 4:this.speed=1;break}C.globalTimeline.timeScale(this.speed)}static updateHP(t,e,s){return new Promise(i=>{const o=u.stage.getChildByName(t).children[2],y={score:e};C.to(y,{duration:1,score:s,onUpdate(){o.text=`${t} : ${y.score.toFixed(0)}`},onComplete:i})})}static death(t){const e=u.stage.getChildByName(t);let s=1;return t=="\u73A9\u5BB6"&&(s=-1),new Promise(i=>{C.to(e.children[0],{duration:.5,rotation:90*s*this.radian,onComplete:i})})}static showDizzy(t){const e=u.stage.getChildByName(t);return new Promise(s=>{C.to(e.children[0],{keyframes:[{duration:.25,rotation:30*this.radian},{duration:.5,rotation:-30*this.radian},{duration:.25,rotation:0*this.radian,onComplete:s}]})})}static showAttack(t){const e=u.stage.getChildByName(t);let s=1;return t=="\u96FB\u8166"&&(s=-1),new Promise(i=>{C.to(e.children[0],{duration:.5,x:200*s,repeat:1,yoyo:!0,onComplete:i})})}static showShield(t){const e=p.from("Shield.png");let s=1;return t=="\u96FB\u8166"&&(s=-1),e.anchor.set(.5,.5),e.position.set(510-100*s,270),u.stage.addChild(e),new Promise(i=>{C.to(e,{duration:1,onComplete:()=>{u.stage.removeChild(e),i("\u5DF2\u5B8C\u6210")}})})}static showMiss(t){const e=p.from("miss.png");let s=1;t=="\u96FB\u8166"&&(s=-1);const i=u.stage.getChildByName(t);return e.anchor.set(.5,.5),e.position.set(510-100*s,270),new Promise(r=>{C.timeline().to(i.children[0],{duration:.5,x:-100*s,repeat:1,yoyo:!0,onComplete:()=>{r("\u5DF2\u5B8C\u6210")}}).to(e,{onComplete:()=>{u.stage.addChild(e)}},.1).to(e,{duration:.5,y:"-=50",onComplete:()=>{u.stage.removeChild(e)}})})}static showDouble(t){const e=u.stage.getChildByName(t),s=p.from("Double.png");let i=-1;return t=="\u73A9\u5BB6"&&(i=1),s.anchor.set(.5,.5),s.scale.x=-1*i,s.position.set(510+100*i,270),new Promise(r=>{C.to(e.children[0],{keyframes:[{duration:.4,x:200*i,onComplete:()=>{u.stage.addChild(s)}},{duration:.15,x:`+=${-100*i}`,repeat:1,yoyo:!0},{duration:.4,x:0,onComplete:()=>{u.stage.removeChild(s),r("\u5DF2\u5B8C\u6210")}}]})})}static showFireBall(t){const e=p.from("FireBall.png");let s=1;return t=="\u73A9\u5BB6"&&(s=-1),e.anchor.set(.5,.5),e.scale.x=s,e.position.set(510+100*s,270),new Promise(i=>{u.stage.addChild(e),C.to(e,{duration:.5,x:510-100*s,onComplete:()=>{u.stage.removeChild(e),i("\u5DF2\u5B8C\u6210")}})})}}h.speed=1;h.radian=Math.PI/180;class P{static async init(t,e,s,i){if(this.showText(s,i),s.state.includes(g.\u6688\u7729)){await h.showDizzy(t.name[0]);return}i.skill.includes(c.\u53CD\u64CA)?h.showShield(e.name[0]):i.skill.includes(c.\u9583\u907F)&&h.showMiss(e.name[0]),s.skill.includes(c.\u706B\u7403)?await h.showFireBall(t.name[0]):s.skill.includes(c.\u9023\u64CA)?(console.log(s.text.proSkill),await h.showDouble(t.name[0])):await h.showAttack(t.name[0])}static showText(t,e){if(Object.keys(t.text).length==0)return;const s=JSON.parse(sessionStorage.getItem("\u6230\u9B25\u7D00\u9304")||"");Object.values(t.text).forEach(i=>{s.push(i)}),sessionStorage.setItem("\u6230\u9B25\u7D00\u9304",JSON.stringify(s))}static death(t){return h.death(t)}}const $=class{static Start(a){const t=u.stage.getChildByName("\u9078\u64C7\u7A2E\u65CF");u.stage.removeChild(t),$.player=a,$.computer=U.create(),new Q(u)}static restart(){v._player=new H("\u73A9\u5BB6"),this.turn=1}static async battle(){if(console.log("-------------------"),this.whoWin(this.player,this.computer))return;const a=new M,t=new M;switch(this.turn%2){case 1:console.log(`${this.player.name[0]}\u7684\u56DE\u5408`),await this.player.action(a,t),await this.computer.action(t,a),await P.init(this.player,this.computer,a,t),await this.calculate(this.player,this.computer,a,t);break;case 0:console.log(`${this.computer.name[0]}\u7684\u56DE\u5408`),await this.computer.action(a,t),await this.player.action(t,a),await P.init(this.computer,this.player,a,t),await this.calculate(this.computer,this.player,a,t);break}this.turn++,this.battle()}static async calculate(a,t,e,s){const i=a.roleInfo.HP,r=t.roleInfo.HP;let o=0,y=0,T=0;e.damage.forEach(m=>{o+=m*e.buff}),e.heal.forEach(m=>{T+=m*e.buff}),s.defDamage.forEach(m=>{y+=m*s.buff}),a.roleInfo.HP+=T-y,t.roleInfo.HP-=o,e.debuff.forEach(m=>{t.roleInfo.state.push(m)}),h.updateHP(a.name[0],i,a.roleInfo.HP),await h.updateHP(t.name[0],r,t.roleInfo.HP)}static whoWin(a,t){return a.roleInfo.HP<=0?(console.log(`%c ${t.name[0]} \u52DD\u5229 `,B.FDF),console.log(`%c ${t.name} > ${a.name} `,B.CCC),console.log(this.turn),P.death(a.name[0]),!0):t.roleInfo.HP<=0?(console.log(`%c ${a.name[0]} \u52DD\u5229 `,B.FDF),console.log(`%c ${a.name} > ${t.name} `,B.CCC),console.log(this.turn),P.death(t.name[0]),!0):!1}};let l=$;l.turn=1;class L{constructor(t){this.app=t,this.battleText(),this.choseText(),this.addClickEvent()}battleText(){const t=this.app.stage.addChild(new d("",{fontSize:16}));sessionStorage.setItem("\u6230\u9B25\u7D00\u9304",JSON.stringify([` \u6230\u9B25\u7D00\u9304
-------`])),this.app.ticker.add(()=>{const e=JSON.parse(sessionStorage.getItem("\u6230\u9B25\u7D00\u9304")||"");t.text=e.join(`
`),e.length>20&&e.shift(),sessionStorage.setItem("\u6230\u9B25\u7D00\u9304",JSON.stringify(e))})}choseText(){const t=new k,e=new d("\u9078\u64C7\u7A2E\u65CF",{fontSize:32}),s=new d(n.\u4EBA\u985E,{fontSize:50}),i=new d(n.\u77EE\u4EBA,{fontSize:50}),r=new d(n.\u5996\u7CBE,{fontSize:50});t.name="\u9078\u64C7\u7A2E\u65CF",t.y=50,s.y=50,i.y=s.y+60,r.y=i.y+60,s.interactive=i.interactive=r.interactive=!0,t.addChild(e,s,i,r),this.app.stage.addChild(t)}addClickEvent(){const t=this.app.stage.getChildByName("\u9078\u64C7\u7A2E\u65CF");for(let e=1;e<4;e++)t.children[e].addListener("click",()=>{v.create(t.children[e])})}}class O{constructor(t){this.app=t,this.container=new k,this.attackButton=p.from("attack.png"),this.restartButton=p.from("restart.png"),this.speedButton=p.from("speed.png"),this.setRestartButton(),this.setAttackButton(),this.setSpeedButton()}setSpeedButton(){this.speedButton.name="\u52A0\u901F\u6309\u9215",this.speedButton.position.set(600,10),this.speedButton.scale.set(.8),this.speedButton.interactive=!0,this.speedButton.addListener("click",()=>{h.doubleSpeed()}),this.app.stage.addChild(this.speedButton)}setRestartButton(){this.restartButton.name="\u91CD\u65B0\u958B\u59CB\u6309\u9215",this.restartButton.position.set(700,10),this.restartButton.scale.set(.8),this.restartButton.interactive=!0,this.restartButton.addListener("click",()=>{sessionStorage.setItem("\u6230\u9B25\u7D00\u9304",JSON.stringify([` \u6230\u9B25\u7D00\u9304
-------`])),this.app.stage.removeChildren(1),new O(this.app),new L(this.app),l.restart()}),this.app.stage.addChild(this.restartButton)}setAttackButton(){this.attackButton.anchor.set(.5);const t=new d("\u653B\u64CA",{fontSize:50,fill:["#000"]});t.anchor.set(.5),this.container.name="\u653B\u64CA\u6309\u9215",this.container.position.set(500,200),this.container.addChild(this.attackButton,t),this.container.interactive=!0,this.container.addListener("click",()=>{l.battle(),this.changeAttackImage()}),this.app.stage.addChild(this.container)}changeAttackImage(){const t=S.from("attack_black.png");S.from("attack.png"),this.attackButton.texture=t,this.container.interactive=!1}}function V(a){const t=new k,e=p.from("background.png"),s=p.from("background.png");t.name="\u80CC\u666F",t.addChild(e,s),e.width=s.width=a.screen.width,e.height=s.height=a.screen.height,s.x=-a.screen.width,a.ticker.add(i=>{e.x>=a.screen.width&&(e.x=-a.screen.width),s.x>=a.screen.width&&(s.x=-a.screen.width),e.x+=1,s.x+=1}),a.stage.addChild(t)}window.__PIXI_INSPECTOR_GLOBAL_HOOK__&&window.__PIXI_INSPECTOR_GLOBAL_HOOK__.register({PIXI:j});let u;function Y(){var a;u=new J({width:800,height:400,antialias:!0,resolution:1}),(a=document.querySelector("#app"))==null||a.appendChild(u.view),u.loader.add("background.png","../img/background.png").add("character.png","../img/character.png").add("speed.png","../img/speed.png").add("../img/spritesheet.json").load(()=>{V(u),new O(u),new L(u)})}Y();
