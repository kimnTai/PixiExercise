<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Week_1</title>
   <!-- bootstrap 5 CSS only -->
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">
</head>

<body>
   <div class="container mt-3">
      <h1>Week1 - 角子老虎機</h1>
      <div class="game"></div>
      <div id="vueApp">
         <div class="mb-2">
            大小 <input v-model='imgSize' class="me-3" type="number">
            列 <input v-model='list' class="me-3" type="number">
         </div>
         <button class="me-3 btn btn-primary" @click='gameStart'>開始遊戲</button>
         <button class="me-3 btn btn-primary" @click='moveSprite'>RUN</button>

      </div>
   </div>



   <!-- Vue CDN -->
   <script src="https://unpkg.com/vue@next"></script>
   <!-- PIXI CDN -->
   <script src="https://pixijs.download/release/pixi.js"></script>
   <script>
      // PIXI app
      const app = new PIXI.Application({
         width: 800, height: 600,
         backgroundColor: 0x000080
      });
      document.querySelector('.game').appendChild(app.view);

      // Vue App
      const vueApp = Vue.createApp({
         data() {
            return {
               imgContainer: new PIXI.Container(),
               imgUrlArray: [
                  './img/one.png',
                  './img/two.png',
                  './img/three.png',
                  './img/four.png',
               ],
               imgSize: 200,
               list: 4,
               runing: false,
            }
         },
         methods: {
            // ------ 開始遊戲 ------ 
            gameStart() {
               if (this.imgContainer.children.length > 0) return
               // 設置圖片位置
               for (let j = 0; j < this.list; j++) {
                  for (let i = 0; i < 6; i++) {
                     // 產生０～４亂數
                     const randomNumber = Math.floor(Math.random() * this.imgUrlArray.length);
                     // 產生圖片
                     const img = new PIXI.Sprite.from(this.imgUrlArray[randomNumber]);
                     // 縮放設定
                     img.scale.set(this.imgSize / 200, this.imgSize / 200);
                     img.y = -this.imgSize * 3 + this.imgSize * i;
                     img.x = j * this.imgSize;
                     // 放入 Conatiner
                     this.imgContainer.addChild(img);
                  }
               }
               // 舞台放置
               app.stage.addChild(this.imgContainer);
            },
            // ------  開始旋轉 ------ 
            moveSprite() {
               if (this.runing == true) return
               this.runing = true
               app.ticker.add(delta => {
                  this.imgContainer.y += 10;
                  if (this.imgContainer.y >= 600) { this.imgContainer.y = 0; }
               });
            },
         },
      }).mount('#vueApp')
   </script>
</body>

</html>